<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Security Bathroom Tracker</title>
    <link rel="stylesheet" href="css/main.css" />
  </head>
  <body>
    <header>Security Bathroom Tracker</header>

    <form
      class="panel"
      id="bathroom-tracker"
      action="https://script.google.com/macros/s/AKfycbyfgyRcACCIHC_qGMT_5vc8m0iwT40pA2Ik25i5DAuQ5BAZKsyM6u_klJ_PU1xO2HoG/exec"
      method="POST"
    >
      <!-- Name Field -->
      <section class="name-input">
        <label for="staffName">Your Name:</label>
        <input
          type="text"
          id="staffName"
          name="Name"
          placeholder="Enter your name"
          required
        />
      </section>

      <!-- Location Buttons (each one submits the form) -->
      <main>
        <button type="submit" name="Location" value="1st Floor Maint T">
          1st Floor Maint T
        </button>
        <button type="submit" name="Location" value="1st Floor Elv T">
          1st Floor Elv T
        </button>
        <button type="submit" name="Location" value="300 POD Bathroom">
          300 POD Bathroom
        </button>
        <button type="submit" name="Location" value="500 POD Bathroom">
          500 POD Bathroom
        </button>
        <button type="submit" name="Location" value="2nd Floor Maint T">
          2nd Floor Maint T
        </button>
        <button type="submit" name="Location" value="2nd Floor Elv T">
          2nd Floor Elv T
        </button>
        <button type="submit" name="Location" value="400 POD Bathroom">
          400 POD Bathroom
        </button>
        <button type="submit" name="Location" value="600 POD Bathroom">
          600 POD Bathroom
        </button>
      </main>
    </form>
    <script>
      (function () {
        // 1) Set your deployed Apps Script Web App URL here:
        const WEB_APP_URL = "https://script.google.com/macros/s/____/exec";

        const form = document.getElementById("bathroom-tracker");
        const nameInput = document.getElementById("staffName");

        // Optional: tiny inline toast
        const toast = document.createElement("div");
        toast.style.position = "fixed";
        toast.style.bottom = "16px";
        toast.style.left = "50%";
        toast.style.transform = "translateX(-50%)";
        toast.style.padding = "8px 12px";
        toast.style.borderRadius = "10px";
        toast.style.fontSize = "0.9rem";
        toast.style.background = "rgba(0,0,0,0.7)";
        toast.style.color = "#fff";
        toast.style.opacity = "0";
        toast.style.transition = "opacity 180ms ease";
        document.body.appendChild(toast);
        function showToast(msg) {
          toast.textContent = msg;
          toast.style.opacity = "1";
          setTimeout(() => (toast.style.opacity = "0"), 1000);
        }

        // 2) Intercept submit; add the clicked button's value as Location
        form.addEventListener("submit", function (e) {
          e.preventDefault();

          // Which button was clicked
          const submitter = e.submitter; // modern browsers
          const locationValue =
            submitter && submitter.name === "Location" ? submitter.value : "";

          const nameValue = (nameInput.value || "").trim();
          if (!nameValue) {
            nameInput.focus();
            showToast("Enter name first");
            return;
          }
          if (!locationValue) {
            showToast("Pick a location");
            return;
          }

          // Build URL-encoded body (simple request â†’ no preflight)
          const params = new URLSearchParams();
          params.append("Name", nameValue);
          params.append("Location", locationValue);

          // 3) Fire-and-forget POST (no-cors to avoid CORS blocking on GitHub Pages)
          fetch(WEB_APP_URL, {
            method: "POST",
            mode: "no-cors",
            headers: { "Content-Type": "application/x-www-form-urlencoded" },
            body: params.toString(),
          }).catch(() => {
            /* ignore network errors on client */
          });

          // 4) Instant UX: reset, refocus, tiny confirmation
          form.reset();
          if (nameInput) nameInput.focus();
          showToast("Recorded");
        });
      })();
    </script>
  </body>
</html>
